---
title: "Modelo oro — Ventas"
owner: "equipo-alumno"
periodicidad: "diaria"
version: "1.0.0"
---

# Tablas oro
- `clean_ventas` (línea de venta)
- `ventas_diarias_producto` (por fecha y producto): columnas `fecha`, `id_producto`, `unidades`, `importe`, `ticket_medio`

# KPIs
- Ingresos netos: Σ(`importe`) = Σ(`unidades * precio_unitario`)
- Ticket medio: `Ingresos / nº_transacciones`
- Top productos: `id_producto` por importe

# SQL conceptual
```sql
-- Ventas diarias por producto
SELECT fecha, id_producto, SUM(unidades) AS unidades, SUM(importe) AS importe,
       SUM(importe)/COUNT(*) AS ticket_medio
FROM clean_ventas
GROUP BY fecha, id_producto;
```

| fecha | id\_producto | unidades | importe | ticket\_medio |
| :--- | :--- | :--- | :--- | :--- |
| 2025-07-07 | P001 | 2 | 5800 | 5800 |
| 2025-07-07 | P002 | 1 | 2100 | 2100 |
| 2025-07-07 | P003 | 3 | 1260 | 1260 |
| 2025-07-07 | P004 | 2 | 620 | 620 |
| 2025-07-07 | P005 | 1 | 3500 | 3500 |
| 2025-07-07 | P006 | 5 | 900 | 900 |
| 2025-07-07 | P007 | 2 | 190 | 190 |
| 2025-07-07 | P008 | 3 | 180 | 180 |
| 2025-07-07 | P009 | 1 | 2800 | 2800 |
| 2025-07-07 | P010 | 2 | 1300 | 1300 |
| 2025-07-07 | P011 | 1 | 520 | 520 |
| 2025-07-07 | P012 | 2 | 960 | 960 |
| 2025-07-07 | P013 | 4 | 340 | 340 |
| 2025-07-07 | P014 | 5 | 225 | 225 |
| 2025-07-07 | P015 | 1 | 890 | 890 |
| 2025-07-07 | P016 | 2 | 500 | 500 |
| 2025-07-07 | P017 | 1 | 420 | 420 |
| 2025-07-07 | P018 | 1 | 370 | 370 |
| 2025-07-07 | P019 | 2 | 620 | 620 |
| 2025-07-07 | P020 | 1 | 1250 | 1250 |
| 2025-07-07 | P021 | 3 | 4350 | 4350 |
| 2025-07-07 | P022 | 1 | 2100 | 2100 |
| 2025-07-07 | P023 | 2 | 840 | 840 |
| 2025-07-07 | P024 | 2 | 620 | 620 |
| 2025-07-07 | P025 | 1 | 3500 | 3500 |
| 2025-07-07 | P026 | 4 | 720 | 720 |
| 2025-07-07 | P027 | 3 | 285 | 285 |
| 2025-07-07 | P028 | 1 | 60 | 60 |
| 2025-07-07 | P029 | 2 | 5600 | 5600 |
| 2025-07-07 | P030 | 1 | 650 | 650 |
| 2025-07-07 | P031 | 1 | 520 | 520 |
| 2025-07-07 | P032 | 2 | 960 | 960 |
| 2025-07-07 | P033 | 1 | 85 | 85 |
| 2025-07-07 | P034 | 4 | 180 | 180 |
| 2025-07-07 | P035 | 1 | 890 | 890 |
| 2025-07-07 | P036 | 2 | 500 | 500 |
| 2025-07-07 | P037 | 1 | 420 | 420 |
| 2025-07-07 | P038 | 1 | 370 | 370 |
| 2025-07-07 | P039 | 3 | 930 | 930 |
| 2025-07-07 | P040 | 2 | 2500 | 2500 |
| 2025-07-07 | P041 | 2 | 2900 | 2900 |
| 2025-07-07 | P042 | 1 | 2100 | 2100 |
| 2025-07-07 | P043 | 1 | 420 | 420 |
| 2025-07-07 | P044 | 2 | 620 | 620 |
| 2025-07-07 | P045 | 1 | 3500 | 3500 |
| 2025-07-07 | P046 | 3 | 540 | 540 |
| 2025-07-07 | P047 | 1 | 95 | 95 |
| 2025-07-07 | P048 | 2 | 120 | 120 |
| 2025-07-07 | P049 | 1 | 2800 | 2800 |
| 2025-07-07 | P050 | 2 | 1300 | 1300 |
| 2025-07-07 | P051 | 1 | 520 | 520 |
| 2025-07-07 | P052 | 1 | 480 | 480 |
| 2025-07-07 | P053 | 1 | 85 | 85 |
| 2025-07-07 | P054 | 4 | 180 | 180 |
| 2025-07-07 | P055 | 1 | 890 | 890 |
| 2025-07-07 | P056 | 2 | 500 | 500 |
| 2025-07-07 | P057 | 1 | 420 | 420 |
| 2025-07-07 | P058 | 2 | 740 | 740 |
| 2025-07-07 | P059 | 2 | 620 | 620 |
| 2025-07-07 | P060 | 1 | 1250 | 1250 |
| 2025-07-07 | P061 | 1 | 1450 | 1450 |
| 2025-07-07 | P062 | 2 | 4200 | 4200 |
| 2025-07-07 | P063 | 2 | 840 | 840 |
| 2025-07-07 | P064 | 1 | 310 | 310 |
| 2025-07-07 | P065 | 2 | 7000 | 7000 |
| 2025-07-07 | P066 | 2 | 360 | 360 |
| 2025-07-07 | P067 | 1 | 95 | 95 |
| 2025-07-07 | P068 | 2 | 120 | 120 |
| 2025-07-07 | P069 | 2 | 5600 | 5600 |
| 2025-07-07 | P070 | 1 | 650 | 650 |
| 2025-07-07 | P071 | 1 | 520 | 520 |
| 2025-07-07 | P072 | 2 | 960 | 960 |
| 2025-07-07 | P073 | 1 | 85 | 85 |
| 2025-07-07 | P074 | 3 | 135 | 135 |
| 2025-07-07 | P075 | 1 | 890 | 890 |
| 2025-07-07 | P076 | 2 | 500 | 500 |
| 2025-07-07 | P077 | 1 | 420 | 420 |
| 2025-07-07 | P078 | 2 | 740 | 740 |
| 2025-07-07 | P079 | 2 | 620 | 620 |
| 2025-07-07 | P080 | 1 | 1250 | 1250 |
| 2025-07-07 | P081 | 2 | 2900 | 2900 |
| 2025-07-07 | P082 | 1 | 2100 | 2100 |
| 2025-07-07 | P083 | 2 | 840 | 840 |
| 2025-07-07 | P084 | 2 | 620 | 620 |
| 2025-07-07 | P085 | 1 | 3500 | 3500 |
| 2025-07-07 | P086 | 2 | 360 | 360 |
| 2025-07-07 | P087 | 2 | 190 | 190 |
| 2025-07-07 | P088 | 1 | 60 | 60 |
| 2025-07-07 | P089 | 1 | 2800 | 2800 |
| 2025-07-07 | P090 | 2 | 1300 | 1300 |
| 2025-07-07 | P091 | 2 | 1040 | 1040 |
| 2025-07-07 | P092 | 1 | 480 | 480 |
| 2025-07-07 | P093 | 2 | 170 | 170 |
| 2025-07-07 | P094 | 4 | 180 | 180 |
| 2025-07-07 | P095 | 1 | 890 | 890 |
| 2025-07-07 | P096 | 2 | 500 | 500 |
| 2025-07-07 | P097 | 1 | 420 | 420 |
| 2025-07-07 | P098 | 1 | 370 | 370 |
| 2025-07-07 | P099 | 3 | 930 | 930 |
| 2025-07-07 | P100 | 1 | 1250 | 1250 |
| 2025-07-07 | P101 | 2 | 2900 | 2900 |
| 2025-07-07 | P102 | 1 | 2100 | 2100 |
| 2025-07-07 | P103 | 2 | 840 | 840 |
| 2025-07-07 | P104 | 2 | 620 | 620 |
| 2025-07-07 | P105 | 1 | 3500 | 3500 |
| 2025-07-07 | P106 | 3 | 540 | 540 |
| 2025-07-07 | P107 | 1 | 95 | 95 |
| 2025-07-07 | P108 | 2 | 120 | 120 |
| 2025-07-07 | P109 | 1 | 2800 | 2800 |
| 2025-07-07 | P110 | 2 | 1300 | 1300 |
| 2025-07-07 | P111 | 1 | 520 | 520 |
| 2025-07-07 | P112 | 1 | 480 | 480 |
| 2025-07-07 | P113 | 1 | 85 | 85 |
| 2025-07-07 | P114 | 4 | 180 | 180 |
| 2025-07-07 | P115 | 1 | 890 | 890 |
| 2025-07-07 | P116 | 2 | 500 | 500 |
| 2025-07-07 | P117 | 1 | 420 | 420 |
| 2025-07-07 | P118 | 2 | 740 | 740 |
| 2025-07-07 | P119 | 2 | 620 | 620 |
| 2025-07-07 | P120 | 1 | 1250 | 1250 |

# Nota sobre persistencia (estado actual)

Este repositorio ahora genera y persiste la capa "oro" automáticamente al ejecutar el pipeline `project/ingest/run.py`.
- Tabla SQL persistida: `ventas_diarias_producto` en `project/output/ut1.db`.
- Archivo analítico: `project/output/parquet/ventas_diarias_producto.parquet` (fallback CSV: `project/output/parquet/ventas_diarias_producto.csv`).

Estos artefactos se usan para análisis y entrega (KPIs). Puedes consultar la tabla en la base de datos SQLite o leer directamente el Parquet desde cualquier herramienta analítica.
